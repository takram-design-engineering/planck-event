!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Planck={})}(this,function(t){"use strict";function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=Symbol(t);return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t};return void 0===t[e]&&(t[e]=n({})),t[e]}}function n(t){var e=k(t);return{set target(t){e.target=t||null},set currentTarget(t){e.currentTarget=t||null},set phase(t){e.phase=t||null}}}function r(t,e){return e.object===t.object&&e.name===t.name}function i(t,e){var n=T(this);if(e.target===n.source&&e.name===n.name){var r=t(e.value);n.targets.forEach(function(t){t.object[t.name]=r})}}function o(t){var e=T(t),n=P.type(e.name);e.source.removeEventListener(n,e.handleChange,!1)}function a(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.reduce(function(t,e){return t.concat(e)},[]),i=void 0,o=r.reduce(function(t,e,n){return n%2==0?i=e:t.push({object:i,name:e}),t},[]);return[o,Object.assign({oneWay:o.length>1},r[2*o.length])]}function u(t,e,n,r){var i=w(t);void 0===i.bindings&&(i.bindings={}),void 0===i.bindings[e]&&(i.bindings[e]=[]);var o=i.bindings[e];o.forEach(function(t){t.unbind(n)}),(o=o.filter(function(t){return!t.empty})).push(new S(t,e,n,r)),i.bindings[e]=o}function s(t,e,n){var r=w(t);if(void 0===r.bindings)return[];if(void 0===r.bindings[e])return[];var i=r.bindings[e],o=i.reduce(function(t,e){return t.concat(e.unbind(n))},[]);return i=i.filter(function(t){return!t.empty}),r.bindings[e]=i,o}function c(t,e){var n=w(t);if(void 0===n.bindings)return[];if(void 0===n.bindings[e])return[];var r=n.bindings[e].reduce(function(t,e){return t.concat(e.unbindAll())},[]);return n.bindings[e]=[],r}function l(t,e){if("function"==typeof e)e(t);else{if("function"!=typeof e.handleEvent)throw new Error("Listener is neither function nor event listener");e.handleEvent(t)}}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},h=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},y=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},g=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},d=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n},b=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},m=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),E=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},k=e("Event"),_=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,t),this.init(e)}return h(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.type,n=t.captures,r=void 0!==n&&n,i=t.bubbles,o=void 0===i||i,a=k(this);return a.type=e||null,a.captures=!!r,a.bubbles=!!o,a.timestamp=Date.now(),a.propagationStopped=!1,a.immediatePropagationStopped=!1,a.target=null,a.currentTarget=null,a.phase=null,this}},{key:"stopPropagation",value:function(){k(this).propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){var t=k(this);t.propagationStopped=!0,t.immediatePropagationStopped=!0}},{key:"type",get:function(){return k(this).type}},{key:"target",get:function(){return k(this).target}},{key:"currentTarget",get:function(){return k(this).currentTarget}},{key:"phase",get:function(){return k(this).phase}},{key:"captures",get:function(){return k(this).captures}},{key:"bubbles",get:function(){return k(this).bubbles}},{key:"timestamp",get:function(){return k(this).timestamp}},{key:"propagationStopped",get:function(){return k(this).propagationStopped}},{key:"immediatePropagationStopped",get:function(){return k(this).immediatePropagationStopped}}]),t}(),O=function(t){function e(){return p(this,e),b(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,_),h(e,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.type,i=t.target,o=d(t,["type","target"]);return y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,v({type:r},o)),n(this).target=i||null,this}}]),e}(),j=e("StateEvent"),P=function(t){function e(){return p(this,e),b(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,O),h(e,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.name,r=t.value,i=d(t,["name","value"]);y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,v({},i,{type:e.type(n)}));var o=j(this);return o.name=n,o.value=r,this}},{key:"name",get:function(){return j(this).name}},{key:"value",get:function(){return j(this).value}}],[{key:"type",value:function(t){return"state:"+(null===t||void 0===t?"":t)}}]),e}(),T=e("Binder"),S=function(){function t(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=o.assigns,u=void 0!==a&&a,s=o.transform,c=void 0===s?function(t){return t}:s;p(this,t);var l=T(this);l.source=e,l.name=n,l.targets=[].concat(E(r)),l.handleChange=i.bind(this,c);var f=P.type(n);l.source.addEventListener(f,l.handleChange,!1),u&&r.forEach(function(t){t.object[t.name]=c(e[n])})}return h(t,[{key:"matches",value:function(t){var e=T(this);return!(!Array.isArray(t)||0===t.length)&&t.every(function(t){return e.targets.some(function(e){return r(e,t)})})}},{key:"unbind",value:function(t){if(!t)return this.unbindAll();var e=T(this),n=t.reduce(function(t,n){var i=e.targets.findIndex(function(t){return r(n,t)});return-1!==i&&(e.targets.splice(i,1),t.push(n)),t},[]);return 0===e.targets.length&&o(this),n}},{key:"unbindAll",value:function(){var t=T(this),e=t.targets;return t.targets=[],o(this),e}},{key:"empty",get:function(){return 0===T(this).targets.length}}]),t}(),w=e("Binding"),K=function(){function t(){p(this,t)}return h(t,null,[{key:"bind",value:function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=a.apply(void 0,r),s=m(o,2),c=s[0],l=s[1];l.oneWay||c.forEach(function(n){u(n.object,n.name,[{object:t,name:e}],{assigns:!1,transform:l.inverseTransform})}),u(t,e,c,{assigns:!0,transform:l.transform})}},{key:"unbind",value:function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=a.apply(void 0,r),u=m(o,2),c=u[0],l=u[1],f=s(t,e,c);l.oneWay||f.forEach(function(n){s(n.object,n.name,[{object:t,name:e}])})}},{key:"unbindAll",value:function(t,e){c(t,e).forEach(function(t){c(t.object,t.name)})}}]),t}(),A=e("EventBundle"),x=function(t){function e(){return p(this,e),b(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,_),h(e,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.originalEvent,r=d(t,["originalEvent"]);return y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,v({},r)),A(this).originalEvent=n||null,this}},{key:"preventDefault",value:function(){var t=A(this);null!==t.originalEvent&&t.originalEvent.preventDefault()}},{key:"defaultPrevented",get:function(){var t=A(this);return null!==t.originalEvent&&t.originalEvent.defaultPrevented}},{key:"originalEvent",get:function(){return A(this).originalEvent}}]),e}(),L=function(t){function e(){return p(this,e),b(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,O),h(e,[{key:"init",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.type,i=n.target,o=n.captures,a=void 0!==o&&o,u=n.bubbles,s=void 0!==u&&u,c=d(n,["type","target","captures","bubbles"]);return y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,{type:r,target:i,captures:a,bubbles:s}),Object.entries(c).forEach(function(e){var n=m(e,2),r=n[0],i=n[1];if({}.hasOwnProperty.call(t,r))throw new Error('Name "'+r+'" cannot be used for event property');t[r]=i}),this}}]),e}(),I=e("EventDispatcher"),X=function(){function t(){p(this,t),I(this).listeners={}}return h(t,[{key:"addEventListener",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("function"!=typeof e&&"object"!==(void 0===e?"undefined":f(e)))throw new Error("Attempt to add non-function non-object listener");var r=I(this);void 0===r.listeners[t]&&(r.listeners[t]={bubble:[],capture:[]});var i=n?r.listeners[t].capture:r.listeners[t].bubble;i.includes(e)||i.push(e)}},{key:"removeEventListener",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=I(this);if(void 0!==r.listeners[t]){var i=n?r.listeners[t].capture:r.listeners[t].bubble,o=i.indexOf(e);-1!==o&&i.splice(o,1)}}},{key:"on",value:function(){return this.addEventListener.apply(this,arguments),this}},{key:"off",value:function(){return this.removeEventListener.apply(this,arguments),this}},{key:"once",value:function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=this;return this.addEventListener.apply(this,[t,function n(i){l(i,e),o.removeEventListener.apply(o,[t,n].concat(r))}].concat(r)),this}},{key:"dispatchEvent",value:function(t){var e=t;e instanceof _||(e=new L(t));var r=n(e);e.target||(r.target=this),r.currentTarget=this;var i=I(this).listeners[e.type];if(void 0!==i){var o=e.phase;o&&"target"!==o&&"capture"!==o||[].concat(E(i.capture)).some(function(t){return l(e,t),e.immediatePropagationStopped}),e.immediatePropagationStopped||o&&"target"!==o&&"bubble"!==o||[].concat(E(i.bubble)).some(function(t){return l(e,t),e.immediatePropagationStopped})}}}]),t}(),Y=e("EventTarget"),B=function(t){function e(){p(this,e);var t=b(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),n=Y(t);return n.ancestorEventTarget=null,n.descendantEventTarget=null,t}return g(e,X),h(e,[{key:"determinePropagationPath",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=[];if(null!==t&&void 0!==t)for(var n=t;null!==n&&void 0!==n&&(e.unshift(n),n=n.ancestorEventTarget,!e.includes(n)););else for(var r=this;null!==r&&void 0!==r&&(e.push(r),r=r.descendantEventTarget,!e.includes(r)););return e}},{key:"dispatchImmediateEvent",value:function(t){y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"dispatchEvent",this).call(this,t)}},{key:"dispatchEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t;r instanceof _||(r=new L(t));var i=n(r);if(r.captures||r.bubbles){var o=void 0;o=Array.isArray(e)?[].concat(E(e)):this.determinePropagationPath(r.target||this),null===r.target?i.target=o.pop():o.pop();var a=[].concat(E(o));a.reverse(),r.captures&&(i.phase="capture",o.some(function(t){return t.dispatchImmediateEvent(r),r.propagationStopped})),r.propagationStopped||!Number.isInteger(r.target)&&(i.phase="target",r.target.dispatchImmediateEvent(r),r.propagationStopped)||r.bubbles&&(i.phase="bubble",a.some(function(t){return t.dispatchImmediateEvent(r),r.propagationStopped}))}else this.dispatchImmediateEvent(r)}},{key:"ancestorEventTarget",get:function(){return Y(this).ancestorEventTarget},set:function(t){Y(this).ancestorEventTarget=t||null}},{key:"descendantEventTarget",get:function(){return Y(this).descendantEventTarget},set:function(t){Y(this).descendantEventTarget=t||null}}]),e}(),D=function(t){function e(){return p(this,e),b(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,x),h(e,[{key:"key",get:function(){return this.originalEvent.key}},{key:"code",get:function(){return this.originalEvent.code}},{key:"ctrlKey",get:function(){return this.originalEvent.ctrlKey}},{key:"shiftKey",get:function(){return this.originalEvent.shiftKey}},{key:"altKey",get:function(){return this.originalEvent.altKey}},{key:"metaKey",get:function(){return this.originalEvent.metaKey}},{key:"repeat",get:function(){return this.originalEvent.repeat}}]),e}(),C=e("MouseEvent"),W=function(t){function e(){return p(this,e),b(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,x),h(e,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.x,r=t.y,i=t.movementX,o=t.movementY,a=d(t,["x","y","movementX","movementY"]);y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,v({},a));var u=C(this);return u.x=n||0,u.y=r||0,u.movementX=i||0,u.movementY=o||0,this}},{key:"x",get:function(){return C(this).x}},{key:"y",get:function(){return C(this).y}},{key:"movementX",get:function(){return C(this).movementX}},{key:"movementY",get:function(){return C(this).movementY}},{key:"button",get:function(){return this.originalEvent.button}},{key:"ctrlKey",get:function(){return this.originalEvent.ctrlKey}},{key:"shiftKey",get:function(){return this.originalEvent.shiftKey}},{key:"altKey",get:function(){return this.originalEvent.altKey}},{key:"metaKey",get:function(){return this.originalEvent.metaKey}}]),e}(),M=e("Touch"),N=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,t),this.init(e)}return h(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=t.y,r=t.target,i=t.originalTouch,o=M(this);return o.x=e||0,o.y=n||0,o.target=r||null,o.originalTouch=i||null,this}},{key:"x",get:function(){return M(this).x}},{key:"y",get:function(){return M(this).y}},{key:"target",get:function(){return M(this).target}},{key:"originalTouch",get:function(){return M(this).originalTouch}},{key:"identifier",get:function(){return this.originalTouch.identifier}}]),t}(),Z=e("TouchEvent"),F=function(t){function e(){return p(this,e),b(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,x),h(e,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.touches,r=t.changedTouches,i=d(t,["touches","changedTouches"]);y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,v({},i));var o=Z(this);return o.touches=n,o.changedTouches=r,this}},{key:"touches",get:function(){return Z(this).touches}},{key:"changedTouches",get:function(){return Z(this).changedTouches}},{key:"ctrlKey",get:function(){return this.originalEvent.ctrlKey}},{key:"shiftKey",get:function(){return this.originalEvent.shiftKey}},{key:"altKey",get:function(){return this.originalEvent.altKey}},{key:"metaKey",get:function(){return this.originalEvent.metaKey}}]),e}(),G=e("TouchList"),R=function(){function t(){p(this,t),G(this).array=[],this.init.apply(this,arguments)}return h(t,[{key:"init",value:function(t){var e=G(this);if(e.array.length=0,Array.isArray(t)){var n;(n=e.array).push.apply(n,E(t))}else if(t){for(var r,i=arguments.length,o=Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];(r=e.array).push.apply(r,[t].concat(o))}}},{key:"item",value:function(t){return G(this).array[t]}},{key:"length",get:function(){return G(this).array.length}}]),t}(),q=function(t){function e(){return p(this,e),b(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,W),h(e,[{key:"deltaX",get:function(){return this.originalEvent.deltaX}},{key:"deltaY",get:function(){return this.originalEvent.deltaY}},{key:"deltaZ",get:function(){return this.originalEvent.deltaZ}}]),e}();t.Binder=S,t.Binding=K,t.CustomEvent=O,t.Event=_,t.modifyEvent=n,t.EventBundle=x,t.EventDispatcher=X,t.EventTarget=B,t.GenericEvent=L,t.KeyboardEvent=D,t.MouseEvent=W,t.StateEvent=P,t.Touch=N,t.TouchEvent=F,t.TouchList=R,t.WheelEvent=q,Object.defineProperty(t,"__esModule",{value:!0})});