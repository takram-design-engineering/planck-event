!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Planck=t.Planck||{})}(this,function(t){"use strict";function e(t){var n=Symbol(t);return function(t,e){return null==t[n]&&(t[n]="function"==typeof e?e({}):{}),t[n]}}var n=function(){try{if(new Function("return this === window")())return!0}catch(t){}return!1}(),r=!n&&function(){try{if(new Function("return this === self")())return!0}catch(t){}return!1}(),i=!n&&!r&&function(){try{if(new Function("return this === global")())return!0}catch(t){}return!1}(),c=n?window:r?self:i?global:void 0,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}(),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},h=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},v=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},y=function(t,e){var n={};for(var r in t)0<=e.indexOf(r)||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n},g=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},d=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},b=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},f=e("Event"),m=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};p(this,e),this.init(t)}return s(e,[{key:"init",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.type,n=t.captures,r=void 0!==n&&n,i=t.bubbles,o=void 0===i||i,a=t.cancelable,u=void 0===a||a,s=f(this);return s.type=null!=e?e:null,s.captures=!!r,s.bubbles=!!o,s.cancelable=!!u,s.timeStamp=c.performance&&c.performance.now&&c.performance.now()||Date.now(),s.propagationStopped=!1,s.immediatePropagationStopped=!1,s.defaultPrevented=!1,s.target=null,s.currentTarget=null,s.eventPhase=null,this}},{key:"stopPropagation",value:function(){f(this).propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){var t=f(this);t.propagationStopped=!0,t.immediatePropagationStopped=!0}},{key:"preventDefault",value:function(){this.cancelable&&(f(this).defaultPrevented=!0)}},{key:"type",get:function(){return f(this).type}},{key:"target",get:function(){return f(this).target}},{key:"currentTarget",get:function(){return f(this).currentTarget}},{key:"eventPhase",get:function(){return f(this).eventPhase}},{key:"captures",get:function(){return f(this).captures}},{key:"bubbles",get:function(){return f(this).bubbles}},{key:"cancelable",get:function(){return f(this).cancelable}},{key:"timeStamp",get:function(){return f(this).timeStamp}},{key:"propagationStopped",get:function(){return f(this).propagationStopped}},{key:"immediatePropagationStopped",get:function(){return f(this).immediatePropagationStopped}},{key:"defaultPrevented",get:function(){return f(this).defaultPrevented}}]),e}();function E(e){return{get target(){return f(e).target},set target(t){f(e).target=null!=t?t:null},get currentTarget(){return f(e).currentTarget},set currentTarget(t){f(e).currentTarget=null!=t?t:null},get eventPhase(){return f(e).eventPhase},set eventPhase(t){f(e).eventPhase=null!=t?t:null}}}var u=function(t){function i(){return p(this,i),g(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return v(i,m),s(i,[{key:"init",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.type,n=t.target,r=y(t,["type","target"]);return h(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"init",this).call(this,l({type:e},r)),E(this).target=null!=n?n:null,this}}]),i}(),_=e("StateEvent"),k=function(t){function o(){return p(this,o),g(this,(o.__proto__||Object.getPrototypeOf(o)).apply(this,arguments))}return v(o,u),s(o,[{key:"init",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.name,n=t.value,r=y(t,["name","value"]);h(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"init",this).call(this,l({},r,{type:o.type(e)}));var i=_(this);return i.name=e,i.value=n,this}},{key:"name",get:function(){return _(this).name}},{key:"value",get:function(){return _(this).value}}],[{key:"type",value:function(t){if("string"!=typeof t)throw new Error("Type name must be a string");return"state:"+t}}]),o}(),O=e("Binder");function P(t,e){return e.object===t.object&&e.name===t.name}function T(t){var e=O(t),n=k.type(e.name);e.source.removeEventListener(n,e.handleChange,!1)}var j=function(){function h(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=r.assigns,o=void 0!==i&&i,a=r.transform,u=void 0===a?function(t){return t}:a;p(this,h);var s=O(this);s.source=t,s.name=e,s.targets=[].concat(b(n)),s.handleChange=function(t,e){var n=O(this);if(e.target===n.source&&e.name===n.name)for(var r=t(e.value),i=0;i<n.targets.length;++i){var o=n.targets[i];o.object[o.name]=r}}.bind(this,u);var c=k.type(e);if(s.source.addEventListener(c,s.handleChange,!1),o)for(var l=0;l<n.length;++l){var f=n[l];f.object[f.name]=u(t[e])}}return s(h,[{key:"matches",value:function(t){var e=O(this);if(!Array.isArray(t)||0===t.length)return!1;for(var n=0;n<t.length;++n){for(var r=!1,i=t[n],o=0;o<e.targets.length;++o)if(P(i,e.targets[o])){r=!0;break}if(!r)return!1}return!0}},{key:"unbind",value:function(t){if(!t)return this.unbindAll();for(var e=O(this),n=[],r=0;r<t.length;++r)for(var i=t[r],o=0;o<e.targets.length;++o)if(P(i,e.targets[o])){e.targets.splice(o,1),n.push(i);break}return 0===e.targets.length&&T(this),n}},{key:"unbindAll",value:function(){var t=O(this),e=t.targets;return t.targets=[],T(this),e}},{key:"empty",get:function(){return 0===O(this).targets.length}}]),h}(),w=e("Binding");function S(){for(var t=[],e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i){var o=n[i];Array.isArray(o)?t.push.apply(t,b(o)):t.push(o)}for(var a=void 0,u=[],s=0;s<t.length;++s)s%2==0?a=t[s]:u.push({object:a,name:t[s]});return[u,Object.assign({oneWay:1<u.length},t[2*u.length])]}function A(t,e,n,r){var i=w(t);null==i.bindings&&(i.bindings={}),null==i.bindings[e]&&(i.bindings[e]=[]);for(var o=i.bindings[e],a=[],u=0;u<o.length;++u){var s=o[u];s.unbind(n),s.empty||a.push(s)}a.push(new j(t,e,n,r)),i.bindings[e]=a}function K(t,e,n){var r=w(t);if(null==r.bindings)return[];if(null==r.bindings[e])return[];for(var i=[],o=r.bindings[e],a=[],u=0;u<o.length;++u){var s=o[u];i.push.apply(i,b(s.unbind(n))),s.empty||a.push(s)}return r.bindings[e]=a,i}function o(t,e){var n=w(t);if(null==n.bindings)return[];if(null==n.bindings[e])return[];for(var r=n.bindings[e],i=[],o=0;o<r.length;++o)i.push.apply(i,b(r[o].unbindAll()));return n.bindings[e]=[],i}var x=function(){function t(){p(this,t)}return s(t,null,[{key:"bind",value:function(t,e){for(var n=arguments.length,r=Array(2<n?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=S.apply(void 0,r),a=d(o,2),u=a[0],s=a[1];if(!s.oneWay)for(var c=0;c<u.length;++c){var l=u[c];A(l.object,l.name,[{object:t,name:e}],{assigns:!1,transform:s.inverseTransform})}A(t,e,u,{assigns:!0,transform:s.transform})}},{key:"unbind",value:function(t,e){for(var n=arguments.length,r=Array(2<n?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=S.apply(void 0,r),a=d(o,2),u=a[0],s=a[1],c=K(t,e,u);if(!s.oneWay)for(var l=0;l<c.length;++l){var f=c[l];K(f.object,f.name,[{object:t,name:e}])}}},{key:"unbindAll",value:function(t,e){for(var n=o(t,e),r=0;r<n.length;++r){var i=n[r];o(i.object,i.name)}}}]),t}(),L=e("EventBundle"),D=function(t){function r(){return p(this,r),g(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return v(r,m),s(r,[{key:"init",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.originalEvent,n=y(t,["originalEvent"]);return h(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"init",this).call(this,l({},n)),L(this).originalEvent=e||null,this}},{key:"preventDefault",value:function(){h(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"preventDefault",this).call(this),this.cancelable&&null!=this.originalEvent&&this.originalEvent.preventDefault()}},{key:"originalEvent",get:function(){return L(this).originalEvent}}]),r}(),I=Symbol("_cachedApplicationRef"),M=Symbol("_mixinRef"),B=Symbol("_originalMixin"),X=function(t,e){return Object.setPrototypeOf(e,t),t[B]||(t[B]=t),e},Y=function(t){return e=X(n=t,function(t){var e=n(t);return e.prototype[M]=n[B],e}),Symbol.hasInstance&&!e.hasOwnProperty(Symbol.hasInstance)&&Object.defineProperty(e,Symbol.hasInstance,{value:function(t){for(var e=this[B];null!=t;){if(t.hasOwnProperty(M)&&t[M]===e)return!0;t=Object.getPrototypeOf(t)}return!1}}),X(r=e,function(t){var e=r[I];if(e||(e=r[I]=Symbol(r.name)),t.hasOwnProperty(e))return t[e];var n=r(t);return t[e]=n});var r,e,n},C=function(t){return new W(t)},W=function(){function e(t){p(this,e),this.superclass=t}return s(e,[{key:"with",value:function(){return Array.from(arguments).reduce(function(t,e){return e(t)},this.superclass)}}]),e}(),F=function(t){function f(){return p(this,f),g(this,(f.__proto__||Object.getPrototypeOf(f)).apply(this,arguments))}return v(f,u),s(f,[{key:"init",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.type,n=t.target,r=t.captures,i=void 0!==r&&r,o=t.bubbles,a=void 0!==o&&o,u=y(t,["type","target","captures","bubbles"]);h(f.prototype.__proto__||Object.getPrototypeOf(f.prototype),"init",this).call(this,{type:e,target:n,captures:i,bubbles:a});for(var s=Object.keys(u),c=0;c<s.length;++c){var l=s[c];if({}.hasOwnProperty.call(this,l))throw new Error('Name "'+l+'" cannot be used for event property');this[l]=u[l]}return this}}]),f}(),R=e("EventDispatcherMixin");function G(t,e){if("function"==typeof e)e(t);else{if("function"!=typeof e.handleEvent)throw new Error("Listener is neither function nor event listener");e.handleEvent(t)}}var N=Y(function(e){return function(t){function o(){var t;p(this,o);for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=g(this,(t=o.__proto__||Object.getPrototypeOf(o)).call.apply(t,[this].concat(n)));return R(i).eventTypes={},i}return v(o,e),s(o,[{key:"addEventListener",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if("function"!=typeof e&&"object"!==(void 0===e?"undefined":a(e)))throw new Error("Attempt to add non-function non-object listener");var r=R(this).eventTypes;null==r[t]&&(r[t]={bubble:[],capture:[]});var i=n?r[t].capture:r[t].bubble;i.includes(e)||i.push(e)}},{key:"removeEventListener",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=R(this).eventTypes;if(null!=r[t]){var i=n?r[t].capture:r[t].bubble,o=i.indexOf(e);-1!==o&&i.splice(o,1)}}},{key:"on",value:function(){return this.addEventListener.apply(this,arguments),this}},{key:"off",value:function(){return this.removeEventListener.apply(this,arguments),this}},{key:"once",value:function(n,r){for(var t=arguments.length,i=Array(2<t?t-2:0),e=2;e<t;e++)i[e-2]=arguments[e];var o=this;return this.addEventListener.apply(this,[n,function t(e){G(e,r),o.removeEventListener.apply(o,[n,t].concat(i))}].concat(i)),this}},{key:"dispatchEvent",value:function(t){var e=t;e instanceof m||(e=new F(t));var n=E(e);null==e.target&&(n.target=this),n.currentTarget=this;var r=R(this).eventTypes[e.type];if(null!=r){var i=e.eventPhase;if(!i||"target"===i||"capture"===i)for(var o=[].concat(b(r.capture)),a=0;a<o.length;++a)if(G(e,o[a]),e.immediatePropagationStopped)return;if(!i||"target"===i||"bubble"===i)for(var u=[].concat(b(r.bubble)),s=0;s<u.length;++s)if(G(e,u[s]),e.immediatePropagationStopped)return}}}]),o}()}),Z=function(t){function e(){return p(this,e),g(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return v(e,t),e}(C(function t(){p(this,t)}).with(N)),q=e("EventTargetMixin"),z=Y(function(e){return function(t){function a(){var t;p(this,a);for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=g(this,(t=a.__proto__||Object.getPrototypeOf(a)).call.apply(t,[this].concat(n))),o=q(i);return o.ancestorEventTarget=null,o.descendantEventTarget=null,i}return v(a,e),s(a,[{key:"determinePropagationPath",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=[];if(null!=t)for(var n=t;null!=n&&(e.unshift(n),n=n.ancestorEventTarget,!e.includes(n)););else for(var r=this;null!=r&&(e.push(r),r=r.descendantEventTarget,!e.includes(r)););return e}},{key:"dispatchImmediateEvent",value:function(t){h(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"dispatchEvent",this).call(this,t)}},{key:"dispatchEvent",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=t;n instanceof m||(n=new F(t));var r=E(n);if(n.captures||n.bubbles){var i=void 0;if(i=Array.isArray(e)?[].concat(b(e)):this.determinePropagationPath(n.target||this),null==n.target?r.target=i.pop():i.pop(),n.captures){r.eventPhase="capture";for(var o=0;o<i.length;++o)if(i[o].dispatchImmediateEvent(n),n.propagationStopped)return}if((Number.isInteger(n.target)||(r.eventPhase="target",n.target.dispatchImmediateEvent(n),!n.propagationStopped))&&n.bubbles){r.eventPhase="bubble";for(var a=i.length-1;0<=a;--a)if(i[a].dispatchImmediateEvent(n),n.propagationStopped)return}}else this.dispatchImmediateEvent(n)}},{key:"ancestorEventTarget",get:function(){return q(this).ancestorEventTarget},set:function(t){q(this).ancestorEventTarget=null!=t?t:null}},{key:"descendantEventTarget",get:function(){return q(this).descendantEventTarget},set:function(t){q(this).descendantEventTarget=null!=t?t:null}}]),a}()}),H=function(t){function e(){return p(this,e),g(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return v(e,t),e}(C(function t(){p(this,t)}).with(N,z)),J=function(t){function e(){return p(this,e),g(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return v(e,D),s(e,[{key:"key",get:function(){return this.originalEvent.key}},{key:"code",get:function(){return this.originalEvent.code}},{key:"ctrlKey",get:function(){return this.originalEvent.ctrlKey}},{key:"shiftKey",get:function(){return this.originalEvent.shiftKey}},{key:"altKey",get:function(){return this.originalEvent.altKey}},{key:"metaKey",get:function(){return this.originalEvent.metaKey}},{key:"repeat",get:function(){return this.originalEvent.repeat}},{key:"location",get:function(){return this.originalEvent.location}}]),e}(),Q=e("MouseEvent"),U=function(t){function u(){return p(this,u),g(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}return v(u,D),s(u,[{key:"init",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=t.y,r=t.movementX,i=t.movementY,o=y(t,["x","y","movementX","movementY"]);h(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"init",this).call(this,l({},o));var a=Q(this);return a.x=e||0,a.y=n||0,a.movementX=r||0,a.movementY=i||0,this}},{key:"x",get:function(){return Q(this).x}},{key:"y",get:function(){return Q(this).y}},{key:"movementX",get:function(){return Q(this).movementX}},{key:"movementY",get:function(){return Q(this).movementY}},{key:"button",get:function(){return this.originalEvent.button}},{key:"ctrlKey",get:function(){return this.originalEvent.ctrlKey}},{key:"shiftKey",get:function(){return this.originalEvent.shiftKey}},{key:"altKey",get:function(){return this.originalEvent.altKey}},{key:"metaKey",get:function(){return this.originalEvent.metaKey}}]),u}(),V=e("Touch"),$=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};p(this,e),this.init(t)}return s(e,[{key:"init",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=t.y,r=t.target,i=t.originalTouch,o=V(this);return o.x=e||0,o.y=n||0,o.target=null!=r?r:null,o.originalTouch=i||null,this}},{key:"x",get:function(){return V(this).x}},{key:"y",get:function(){return V(this).y}},{key:"target",get:function(){return V(this).target}},{key:"originalTouch",get:function(){return V(this).originalTouch}},{key:"identifier",get:function(){return this.originalTouch.identifier}}]),e}(),tt=e("TouchList"),et=function(){function t(){p(this,t),tt(this).array=[],this.init.apply(this,arguments)}return s(t,[{key:"init",value:function(t){var e=[];if(Array.isArray(t))e.push.apply(e,b(t));else if(t){for(var n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.push.apply(e,[t].concat(r))}tt(this).array=e}},{key:"item",value:function(t){return tt(this).array[t]}},{key:"length",get:function(){return tt(this).array.length}}]),t}(),nt=e("TouchEvent"),rt=function(t){function o(){return p(this,o),g(this,(o.__proto__||Object.getPrototypeOf(o)).apply(this,arguments))}return v(o,D),s(o,[{key:"init",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.touches,n=t.changedTouches,r=y(t,["touches","changedTouches"]);h(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"init",this).call(this,l({},r));var i=nt(this);return i.touches=e||new et,i.changedTouches=n||new et,this}},{key:"touches",get:function(){return nt(this).touches}},{key:"changedTouches",get:function(){return nt(this).changedTouches}},{key:"ctrlKey",get:function(){return this.originalEvent.ctrlKey}},{key:"shiftKey",get:function(){return this.originalEvent.shiftKey}},{key:"altKey",get:function(){return this.originalEvent.altKey}},{key:"metaKey",get:function(){return this.originalEvent.metaKey}}]),o}(),it=function(t){function e(){return p(this,e),g(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return v(e,U),s(e,[{key:"deltaX",get:function(){return this.originalEvent.deltaX}},{key:"deltaY",get:function(){return this.originalEvent.deltaY}},{key:"deltaZ",get:function(){return this.originalEvent.deltaZ}}]),e}(),ot={Binder:j,Binding:x,CustomEvent:u,Event:m,EventBundle:D,EventDispatcher:Z,EventDispatcherMixin:N,EventTarget:H,EventTargetMixin:z,GenericEvent:F,KeyboardEvent:J,modifyEvent:E,MouseEvent:U,StateEvent:k,Touch:$,TouchEvent:rt,TouchList:et,WheelEvent:it};t.Binder=j,t.Binding=x,t.CustomEvent=u,t.Event=m,t.EventBundle=D,t.EventDispatcher=Z,t.EventDispatcherMixin=N,t.EventTarget=H,t.EventTargetMixin=z,t.GenericEvent=F,t.KeyboardEvent=J,t.modifyEvent=E,t.MouseEvent=U,t.StateEvent=k,t.Touch=$,t.TouchEvent=rt,t.TouchList=et,t.WheelEvent=it,t.default=ot,Object.defineProperty(t,"__esModule",{value:!0})});